<div class="profile-wrapper">
  <mat-card class="profile-card">
    <mat-card-header>
      <mat-card-title>Restaurant Profil</mat-card-title>
    </mat-card-header>

    <mat-card-content>
      <form [formGroup]="profileForm">

        <mat-form-field appearance="outline" class="full-width">
          <mat-label>Restaurant Name</mat-label>
          <input matInput formControlName="name">
        </mat-form-field>

        <mat-form-field appearance="outline" class="full-width">
          <mat-label>Description</mat-label>
          <input matInput formControlName="description">
        </mat-form-field>

        <mat-form-field appearance="outline" class="full-width">
          <mat-label>Address</mat-label>
          <input matInput formControlName="address">
        </mat-form-field>

        <mat-form-field appearance="outline" class="full-width">
          <mat-label>Minimum order value (€)</mat-label>
          <input matInput type="number" formControlName="min_order_value">
        </mat-form-field>

        <mat-form-field appearance="outline" class="full-width">
          <mat-label>Delivery Radius (km)</mat-label>
          <input matInput type="number" formControlName="delivery_radius">
        </mat-form-field>

        <mat-form-field appearance="outline" class="full-width">
          <mat-label>Category</mat-label>
          <input matInput formControlName="category">
        </mat-form-field>

        <mat-form-field appearance="outline" class="full-width">
          <mat-label>Geo Latitude</mat-label>
          <input matInput type="number" formControlName="geo_lat">
        </mat-form-field>

        <mat-form-field appearance="outline" class="full-width">
          <mat-label>Geo Longitude</mat-label>
          <input matInput type="number" formControlName="geo_lng">
        </mat-form-field>

        <div class="image-upload-section">
          <label for="restaurantImage">Restaurant Bild hochladen:</label>
          <input 
            type="file" 
            id="restaurantImage" 
            accept="image/*" 
            (change)="onImageSelected($event)"
            #fileInput
            style="display: none;"
          />
          <button 
            mat-raised-button 
            color="accent" 
            type="button"
            (click)="fileInput.click()">
            Bild auswählen
          </button>
          <span *ngIf="imageFileName" class="file-name">{{ imageFileName }}</span>
        </div>

        <button mat-raised-button color="primary" [disabled]="!profileForm.valid" (click)="save()">
          Speichern
        </button>

        <div formArrayName="openingHours" style="margin-top: 24px;">
          <h3>Öffnungszeiten</h3>
          <div
            *ngFor="let day of openingHours.controls; let i = index"
            [formGroupName]="i"
            class="day-row"
          >
            <strong>{{ day.value.day }}</strong>

            <mat-form-field>
              <input matInput type="time" formControlName="open">
            </mat-form-field>

            <span>–</span>

            <mat-form-field>
              <input matInput type="time" formControlName="close">
            </mat-form-field>

            <mat-checkbox formControlName="closed">
              geschlossen
            </mat-checkbox>
          </div>
        </div>

        <div *ngIf="payload">
          <h3>Payload Preview</h3>
          <pre>{{ payload | json }}</pre>
        </div>

      </form>
    </mat-card-content>
  </mat-card>
</div>
